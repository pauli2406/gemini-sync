version: 1

exempt_sources:
  - "tests/**"
  - ".github/**"
  - ".gitignore"
  - "LICENSE"
  - "CONTRIBUTING.md"

rules:
  - name: runtime_and_api
    sources:
      - "gemini_sync_bridge/**"
    docs_any_of:
      - "README.md"
      - "docs/getting-started-local.mdx"
      - "docs/architecture.md"
      - "docs/operations-runbook.md"
      - "docs/discovery-engine-cli-playbook.md"

  - name: connector_contract
    sources:
      - "connectors/**"
      - "schemas/connector.schema.json"
      - "schemas/connector.docs-meta.yaml"
    docs_any_of:
      - "README.md"
      - "docs/getting-started-local.mdx"
      - "docs/connector-authoring.md"
      - "docs/connector-mode-sql-pull.md"
      - "docs/connector-mode-rest-pull.md"
      - "docs/connector-mode-rest-push.md"
      - "docs/connector-provider-postgres.md"
      - "docs/connector-provider-mysql.md"
      - "docs/connector-provider-mssql.md"
      - "docs/connector-provider-oracle.md"
      - "docs/connector-provider-http.md"
      - "docs/connector-provider-future.md"
      - "docs/connector-field-reference.md"
      - "docs/discovery-engine-cli-playbook.md"

  - name: orchestrator_and_deploy
    sources:
      - "flows/**"
      - "infra/**"
      - "docker-compose.yml"
      - "Dockerfile"
    docs_any_of:
      - "README.md"
      - "docs/getting-started-local.mdx"
      - "docs/architecture.md"
      - "docs/operations-runbook.md"
      - "docs/discovery-engine-cli-playbook.md"

  - name: governance_and_quality
    sources:
      - "scripts/check_*.py"
      - "scripts/export_openapi.py"
      - "scripts/export_connector_reference.py"
      - "scripts/generate_slo_report.py"
      - "scripts/replay_run_artifacts.py"
      - ".agent/**"
      - "schemas/agent-task.schema.json"
      - "AGENTS.md"
      - "evals/**"
    docs_any_of:
      - "README.md"
      - "AGENTS.md"
      - "docs/connector-authoring.md"
      - "docs/connector-field-reference.md"
      - "docs/roadmap.md"
      - "docs/reliability-phase.md"
      - "docs/api-reference.mdx"
      - "docs/troubleshooting.md"

  - name: docs_site
    sources:
      - "website/**"
    docs_any_of:
      - "README.md"
      - "docs/getting-started-local.mdx"
      - "docs/connector-authoring.md"
      - "docs/connector-mode-sql-pull.md"
      - "docs/connector-mode-rest-pull.md"
      - "docs/connector-mode-rest-push.md"
      - "docs/connector-provider-postgres.md"
      - "docs/connector-provider-mysql.md"
      - "docs/connector-provider-mssql.md"
      - "docs/connector-provider-oracle.md"
      - "docs/connector-provider-http.md"
      - "docs/connector-provider-future.md"
      - "docs/connector-field-reference.md"
      - "docs/operations-runbook.md"
      - "docs/architecture.md"
      - "docs/api-reference.mdx"
      - "docs/troubleshooting.md"

consistency:
  required_files:
    - "README.md"
    - "docs/architecture.md"
    - "docs/operations-runbook.md"
  required_tokens:
    - "gemini-sync-bridge run --connector"
    - "gemini-sync-bridge serve --host 0.0.0.0 --port 8080"
    - "python scripts/check_tdd_guardrails.py"
    - "python scripts/check_docs_drift.py"
